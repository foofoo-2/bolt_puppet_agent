# bolt_puppet_agent

This module configures passwordless SSH authentication from Puppet Master to Agents by using the key pairs generated by the Puppet CA.

This is a small proof of concept that can be used together with bolt to allow issuing commands to the Agents without having to worry about setting up an extra authentication mechanism dedicated to this purpose.

Basically, it configures a new `bolt` user and adds to its `authorized_keys` file the content of the public key of the Puppet Master (found under `/etc/puppetlabs/puppet/ssl/public_keys`). This then allows the following passwordless authentication to work:

```
# SSH login
[root@master ~]# ssh -i /etc/puppetlabs/puppet/ssl/private_keys/master.pem bolt@client
Last login: Sun Mar 17 20:53:16 2019 from master
[bolt@client ~]$

# bolt "integration"
[root@master ~]# bolt command run 'hostname -f' \
  -n client -u bolt --no-host-key-check \
  --private-key /etc/puppetlabs/puppet/ssl/private_keys/master.pem
Started on client...
Finished on client:
  STDOUT:
    client
Successful on 1 node: client
Ran on 1 node in 0.43 seconds
```
